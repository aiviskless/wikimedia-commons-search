(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{123:function(e,t,i){},176:function(e,t,i){"use strict";i.r(t);var n=i(0),a=i.n(n),c=i(14),r=i.n(c),l=(i(123),i(231)),s=i(105),o=i(17),d=i(219),u=i(225),b=i(233),p=i(178),m=i(19),f=i(106),j=i(226),h=i(228),g=i(227),O=i(229),v=i(239),x=i(92),E=(i(125),i(93)),L=i.n(E),S=i(100),w=i.n(S),C=i(11),I=1500,N=";",T=["video/webm","video/mpeg","audio/wav","audio/x-flac","audio/mpeg","audio/midi","audio/webm","application/ogg"],A=["jpg","jpeg","jpe","jif","jfif","png","gif","webp","tiff","psd","raw","svg","pdf"],k=["webm","mpg","mpeg","mpe","mpv","ogv","mp4","m4p","m4v","avi","wmv","mov","qt","flv"],U=["m4a","flac","mp3","wav","wma","aac","ogg","midi"],W=function(e){return e.split("?width")[0]},P=function(e){var t=e.split("/");return W(t[t.length-1])},y=i(57),R=i(77),D=i(74),_=i.n(D),M=i(232),H=i(236),G=i(4),q=function(e){var t=e.onClick,i=e.option;return Object(G.jsxs)(b.a,{display:"flex",flexDirection:"column",onClick:t,children:[Object(G.jsx)(p.a,{children:i.label}),Object(G.jsx)(p.a,{variant:"caption",children:i.description})]})},z=i(98),B=i.n(z),F=i(222),V=i(234),Q=i(224),Y=i(237),J=i(220),K=i(238),X=i(221),Z=Object(d.a)({root:{width:250},input:{width:50}}),$=function(e){var t=e.mediaLimit,i=e.setMediaLimit,n=Z();return Object(G.jsxs)("div",{className:n.root,children:[Object(G.jsx)(p.a,{id:"input-slider",gutterBottom:!0,children:"Media limit"}),Object(G.jsxs)(J.a,{container:!0,spacing:2,alignItems:"center",children:[Object(G.jsx)(J.a,{item:!0,xs:!0,children:Object(G.jsx)(K.a,{value:"number"===typeof t?t:0,onChange:function(e,t){return!(t>I)&&i(t)},"aria-labelledby":"input-slider",color:"secondary",min:10,max:I,step:10})}),Object(G.jsx)(J.a,{item:!0,children:Object(G.jsx)(X.a,{className:n.input,value:t,margin:"dense",onChange:function(e){return!(Number(e.target.value)>I)&&i(""===e.target.value?"":Number(e.target.value))},inputProps:{step:10,min:10,max:I,type:"number","aria-labelledby":"input-slider"}})})]})]})},ee=Object(d.a)({popoverContent:{padding:"8px 16px","& .MuiFormControlLabel-labelPlacementStart":{margin:0}},sliderWrapper:{marginTop:16}}),te=function(e){var t=e.setIncludeSubclassSearch,i=e.includeSubclassSearch,a=e.setMediaLimit,c=e.mediaLimit,r=Object(n.useState)(null),l=Object(o.a)(r,2),s=l[0],d=l[1],u=Boolean(s),b=u?"simple-popover":void 0,p=ee();return Object(G.jsxs)("div",{children:[Object(G.jsx)(F.a,{size:"small","aria-describedby":b,onClick:function(e){d(e.currentTarget)},children:Object(G.jsx)(B.a,{})}),Object(G.jsx)(V.a,{id:b,open:u,anchorEl:s,onClose:function(){d(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(G.jsxs)("div",{className:p.popoverContent,children:[Object(G.jsx)(Q.a,{value:"start",checked:i,onChange:function(e){t(e.target.checked)},control:Object(G.jsx)(Y.a,{size:"small"}),label:"Include subclass search",labelPlacement:"start"}),Object(G.jsx)("div",{className:p.sliderWrapper,children:Object(G.jsx)($,{setMediaLimit:a,mediaLimit:c})})]})})]})},ie=_()({instance:"https://www.wikidata.org",sparqlEndpoint:"https://query.wikidata.org/sparql"}),ne=_()({instance:"https://commons.wikimedia.org/",sparqlEndpoint:"https://wcqs-beta.wmflabs.org/sparql"}),ae=Object(d.a)({root:{maxWidth:500,width:"100%",display:"flex",alignItems:"center"},autocomplete:{width:"100%"},searchSettingsWrapper:{marginRight:8}}),ce=function(e){var t=e.setNoResults,i=e.setEntityMediaResults,a=e.setResultsLoading,c=Object(n.useState)(!1),r=Object(o.a)(c,2),l=r[0],s=r[1],d=Object(n.useState)(null),b=Object(o.a)(d,2),p=b[0],f=b[1],j=Object(n.useState)(""),h=Object(o.a)(j,2),g=h[0],O=h[1],v=Object(n.useState)([]),x=Object(o.a)(v,2),E=x[0],L=x[1],S=Object(n.useState)(!0),w=Object(o.a)(S,2),I=w[0],T=w[1],A=Object(n.useState)(1e3),k=Object(o.a)(A,2),U=k[0],W=k[1],P=Object(C.e)(),D=Object(C.d)(),_=Object(n.useRef)(null),z=ae();return Object(n.useEffect)((function(){var e=P.search.replace("?search=","").split(N),n=e[0],c=e[1];if(!n||!c)return!1;c!==g&&fetch(ie.searchEntities(c)).then((function(e){return e.json()})).then((function(e){L(e.search),f(e.search.find((function(e){return e.id===n})))})),i([]),a(!0);var r,l=[],s="\n      SELECT ?file ?fileLabel ?thumb ?fileOrig ?encoding ?creator (GROUP_CONCAT(?depictID; separator = '".concat(N,"') AS ?depictIDs) (GROUP_CONCAT(?depictLabel; separator = '").concat(N,"') AS ?depictLabels)\n      WITH {  \n          SELECT ?file ?fileLabel ?thumb ?fileOrig ?encoding ?creator WHERE {\n            ?file wdt:P180 wd:").concat(n,' .\n            ?file schema:contentUrl ?url .\n            ?file schema:encodingFormat ?encoding .\n            \n            OPTIONAL { ?file p:P170/pq:P4174 ?creator . }\n      \n            SERVICE wikibase:label {\n              bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en".\n              ?file rdfs:label ?fileLabel.\n            }\n      \n            bind(iri(concat("http://commons.wikimedia.org/wiki/Special:FilePath/", wikibase:decodeUri(substr(str(?url),53)), "?width=').concat(m.isMobile?100:200,'")) AS ?thumb)\n            bind(iri(concat("http://commons.wikimedia.org/wiki/Special:FilePath/", wikibase:decodeUri(substr(str(?url),53)))) AS ?fileOrig)\n          } limit ').concat(U,'\n      } as %files\n      \n      WITH {\n        SELECT ?file ?depict WHERE {\n          INCLUDE %files .\n          ?file wdt:P180 ?depict .\n        }\n      } AS %file_depicts\n      \n      WITH {\n        SELECT ?file ?depict WHERE {\n          INCLUDE %file_depicts .\n        }\n      } AS %top_file_depicts\n      \n      WITH {\n        SELECT DISTINCT ?depict WHERE {\n          INCLUDE %file_depicts .\n        }\n      } AS %distinct_depicts\n        \n      WITH {\n        SELECT ?depict ?depictLabel ?depictID WHERE {\n          INCLUDE %distinct_depicts .\n\n          BIND(?depict as ?depictURL) .\n          service wikibase:label {\n            bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en" .\n            ?depictURL rdfs:label ?depictID .\n          }\n\n          service <https://query.wikidata.org/sparql> {\n            service wikibase:label {\n              bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en".\n              ?depict rdfs:label ?depictLabel.\n            }\n          }\n        }\n      } AS %depictLabels\n      \n      WHERE {\n        INCLUDE %files .\n        INCLUDE %top_file_depicts .\n        INCLUDE %depictLabels .\n      } GROUP BY ?file ?fileLabel ?thumb ?fileOrig ?encoding ?creator\n    ');return r=ne.sparqlQuery(s),fetch(r).then((function(e){return e.json()})).then((function(e){return l=l.concat(e.results.bindings),t(!1),i(Object(R.a)(l)),I?(l.length>0&&a(!1),s="\n        SELECT DISTINCT ?item ?itemLabel ?file ?thumb ?fileOrig ?fileLabel ?encoding ?creator (GROUP_CONCAT(?depictID; separator = '".concat(N,"') AS ?depictIDs) (GROUP_CONCAT(?depictLabel; separator = '").concat(N,"') AS ?depictLabels) WITH { \n          SELECT ?item ?itemLabel WHERE {\n            SERVICE <https://query.wikidata.org/sparql> {\n              ?item wdt:P31/wdt:P279* wd:").concat(n,' .\n              SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". ?item rdfs:label ?itemLabel . }\n            }\n          } limit ').concat(U,'\n        } AS %Wikidataitems\n  \n        WITH {\n          SELECT ?file ?thumb ?fileOrig ?fileLabel ?encoding ?creator {\n            INCLUDE %Wikidataitems .\n            ?file wdt:P180 ?item.\n            ?file schema:contentUrl ?url .\n            ?file schema:encodingFormat ?encoding .\n  \n            OPTIONAL {\n              ?file p:P170/pq:P4174 ?creator .\n            }\n  \n            SERVICE wikibase:label {\n              bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en".\n              ?file rdfs:label ?fileLabel.\n            }\n\n            bind(iri(concat("http://commons.wikimedia.org/wiki/Special:FilePath/", wikibase:decodeUri(substr(str(?url),53)), "?width=').concat(m.isMobile?100:200,'")) AS ?thumb)\n            bind(iri(concat("http://commons.wikimedia.org/wiki/Special:FilePath/", wikibase:decodeUri(substr(str(?url),53)))) AS ?fileOrig)\n          }\n        } AS %files\n\n        WITH {\n          SELECT ?file ?depict WHERE {\n            INCLUDE %files .\n            ?file wdt:P180 ?depict .\n          }\n        } AS %file_depicts\n        \n        WITH {\n          SELECT ?file ?depict WHERE {\n            INCLUDE %file_depicts .\n          }\n        } AS %top_file_depicts\n        \n        WITH {\n          SELECT DISTINCT ?depict WHERE {\n            INCLUDE %file_depicts .\n          }\n        } AS %distinct_depicts\n          \n        WITH {\n          SELECT ?depict ?depictLabel ?depictID WHERE {\n            INCLUDE %distinct_depicts .\n\n            BIND(?depict as ?depictURL) .\n            service wikibase:label {\n              bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en" .\n              ?depictURL rdfs:label ?depictID .\n            }\n\n            service <https://query.wikidata.org/sparql> {\n              service wikibase:label {\n                bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en" .\n                ?depict rdfs:label ?depictLabel .\n              }\n            }\n          }\n        } AS %depictLabels\n\n        WHERE {\n          INCLUDE %files .\n          INCLUDE %top_file_depicts .\n          INCLUDE %depictLabels .\n        } GROUP BY ?item ?itemLabel ?file ?thumb ?fileOrig ?fileLabel ?encoding ?creator\n      '),r=ne.sparqlQuery(s),fetch(r).then((function(e){return e.json()})).then((function(e){l=l.concat(e.results.bindings),i(Object(R.a)(l)),0===l.length&&t(!0),a(!1)})),!0):(0===l.length&&t(!0),a(!1),!0)})),!0}),[I,P]),Object(n.useEffect)((function(){if(""!==g)return _.current&&clearTimeout(_.current),_.current=setTimeout((function(){s(!0);var e=ie.searchEntities(g);fetch(e).then((function(e){return e.json()})).then((function(e){L(e.search),s(!1)}))}),500),!0;t(!1)}),[g,t]),Object(G.jsxs)("div",{className:z.root,children:[Object(G.jsx)("div",{className:z.searchSettingsWrapper,children:Object(G.jsx)(te,{setIncludeSubclassSearch:T,includeSubclassSearch:I,setMediaLimit:W,mediaLimit:U})}),Object(G.jsx)(H.a,{clearOnBlur:!1,autoHighlight:!0,options:E,renderOption:function(e){return Object(G.jsx)(q,{option:e})},getOptionSelected:function(e,t){return e.title===t.title},getOptionLabel:function(e){return e.label},loading:l,filterOptions:function(e){return e},value:p,size:"small",onChange:function(e,t){f(t),D.push("?search=".concat(t.id).concat(N).concat(t.label))},onInputChange:function(e,t){O(t)},className:z.autocomplete,renderInput:function(e){return Object(G.jsx)(M.a,Object(y.a)(Object(y.a)({},e),{},{label:"Search Commons...",variant:"outlined",InputProps:Object(y.a)(Object(y.a)({},e.InputProps),{},{endAdornment:Object(G.jsxs)(G.Fragment,{children:[l?Object(G.jsx)(u.a,{color:"inherit",size:20}):null,E.length>0?e.InputProps.endAdornment:null]})})}))}})]})},re=function(e){return e.length>150?"".concat(e.substr(0,50),"..."):e},le=Object(d.a)({root:{height:"fit-content",margin:m.isMobile?8:16,width:m.isMobile?125:225,"& .MuiCardContent-root":{padding:8},"& .MuiCardActions-root":{padding:4}},title:{wordBreak:"break-all",fontSize:m.isMobile?12:14},media:{"& img":{objectFit:"cover !important"},"& img:hover":{cursor:"zoom-in !important"}},desc:{fontSize:m.isMobile?10:12,marginBottom:4},creatorWrapper:{display:"flex",alignItems:"center","& svg":{display:"flex",alignItems:"center",fontSize:20,color:"gray",transform:"translateY(-2px)",marginRight:4}},chipsWrapper:{display:"flex",flexWrap:"wrap",margin:"8px 0","& > div":{margin:2,height:m.isMobile?16:20},"& span":{fontSize:m.isMobile?10:11}}}),se=function(e){var t,i=e.data,a=i.thumb,c=i.fileLabel,r=i.file,l=i.encoding,s=i.fileOrig,d=i.itemLabel,u=i.creator,b=i.depictLabels,f=i.depictIDs,E=e.onClick,S=void 0===E?function(){}:E,I=Object(n.useState)(0),A=Object(o.a)(I,2),k=A[0],U=A[1],W=le(),y=Object(C.d)();return Object(n.useEffect)((function(){if(!u)return!1;var e='\n      SELECT (COUNT(?file) as ?count) WHERE {\n        BIND("'.concat(u.value,'" AS ?username) .\n        ?file (p:P170/pq:P4174) ?username;\n      }\n      LIMIT 99\n    ');return fetch(ne.sparqlQuery(e)).then((function(e){return e.json()})).then((function(e){var t;(null===(t=e.results.bindings)||void 0===t?void 0:t.length)&&U(e.results.bindings[0].count.value)})),!0}),[u]),Object(G.jsxs)(j.a,{className:W.root,children:[Object(G.jsx)("div",{className:W.media,children:T.includes(l.value)?Object(G.jsx)(L.a,{controls:!0,url:s.value,height:m.isMobile?94:169,width:m.isMobile?125:225}):Object(G.jsx)(x.LazyLoadImage,{onClick:S,alt:r.value,effect:"blur",src:a.value,height:m.isMobile?94:169,width:m.isMobile?125:225})}),Object(G.jsxs)(g.a,{children:[Object(G.jsx)(p.a,{className:W.title,gutterBottom:!0,children:(t=P(s.value),t.length>50?"".concat(t.substr(0,50),"..."):t)}),(null===c||void 0===c?void 0:c["xml:lang"])?Object(G.jsx)(p.a,{color:"textSecondary",className:W.desc,children:re(c.value)}):(null===d||void 0===d?void 0:d.value)&&Object(G.jsx)(p.a,{color:"textSecondary",className:W.desc,children:re(d.value)}),(null===b||void 0===b?void 0:b.value)&&Object(G.jsx)("div",{className:W.chipsWrapper,children:n.Children.toArray(b.value.split(N).map((function(e,t){return Object(G.jsx)(v.a,{size:"small",label:e,onClick:function(){return function(e,t){y.push("?search=".concat(f.value.split(N)[t]).concat(N).concat(e))}(e,t)}})})))}),u&&Object(G.jsxs)("div",{className:W.creatorWrapper,children:[Object(G.jsx)(w.a,{}),Object(G.jsx)(p.a,{color:"textSecondary",variant:"caption",children:"".concat(u.value," (").concat(k||"?",")")})]})]}),Object(G.jsx)(h.a,{children:Object(G.jsx)(O.a,{size:"small",color:"primary",href:r.value,target:"_blank",children:"Learn More"})})]})},oe=i(235),de=i(230),ue=i(104),be=i.n(ue),pe=i(103),me=i.n(pe),fe=i(102),je=i.n(fe),he=i(101),ge=i.n(he),Oe=Object(d.a)({root:{minHeight:36},tab:{padding:0,minHeight:32,minWidth:85,fontSize:12,textTransform:"capitalize","& .MuiTab-wrapper":{flexDirection:"row","& .MuiSvgIcon-root":{margin:"0 4px 0 0"}}},icon:{fontSize:20}}),ve=function(e){var t=e.setTab,i=e.tab,n=Oe(),a=[{label:"All",icon:Object(G.jsx)(ge.a,{className:n.icon})},{label:"Images",icon:Object(G.jsx)(je.a,{className:n.icon})},{label:"Video",icon:Object(G.jsx)(me.a,{className:n.icon})},{label:"Audio",icon:Object(G.jsx)(be.a,{className:n.icon})}];return Object(G.jsx)(oe.a,{value:i,indicatorColor:"primary",textColor:"primary",onChange:function(e,i){t(i)},className:n.root,children:a.map((function(e){var t=e.label,i=e.icon;return Object(G.jsx)(de.a,{className:n.tab,label:t,icon:i},t)}))})},xe=function(e){var t=e.split(".");return t[t.length-1]},Ee=Object(d.a)({root:{padding:m.isMobile?"20px 10px":"25px 50px",display:"flex",flexDirection:"column",alignItems:"center"},inputWrapper:{marginBottom:8,width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},loadingWrapper:{position:"absolute",top:"50%"},count:{marginTop:12},wrapper:{marginTop:12,display:"flex",flexDirection:"column",alignItems:"center"}}),Le=function(){var e=Ee(),t=Object(n.useState)([]),i=Object(o.a)(t,2),a=i[0],c=i[1],r=Object(n.useState)(!1),l=Object(o.a)(r,2),s=l[0],d=l[1],m=Object(n.useState)(!1),j=Object(o.a)(m,2),h=j[0],g=j[1],O=Object(n.useState)(!1),v=Object(o.a)(O,2),x=v[0],E=v[1],L=Object(n.useState)(0),S=Object(o.a)(L,2),w=S[0],C=S[1],I=function(){var e=function(e,t){return e.filter((function(e){return t.includes(xe(P(e.fileOrig.value)))||t.includes(xe(P(e.fileOrig.value.toLowerCase())))}))};switch(w){case 1:return e(a,A);case 2:return e(a,k);case 3:return e(a,U);default:return a}}();return console.log(a,"entityMediaResults"),console.log(I),Object(G.jsxs)("div",{className:e.root,children:[Object(G.jsxs)("div",{className:e.inputWrapper,children:[Object(G.jsx)(ce,{setNoResults:d,setEntityMediaResults:c,setResultsLoading:E}),a.length>0&&Object(G.jsxs)("div",{className:e.wrapper,children:[Object(G.jsx)(ve,{setTab:C,tab:w}),Object(G.jsx)("small",{className:e.count,children:"".concat(I.length," results")})]})]}),x&&Object(G.jsx)("div",{className:e.loadingWrapper,children:Object(G.jsx)(u.a,{})}),I.length>0&&Object(G.jsx)(b.a,{display:"flex",flexWrap:"wrap",justifyContent:"center",children:n.Children.toArray(I.map((function(e){return Object(G.jsx)(se,{data:e,onClick:function(){return g(e)}})})))}),s&&Object(G.jsx)(p.a,{children:"No results..."}),h&&Object(G.jsx)(f.a,{large:h.fileOrig.value,alt:h.file.value,onClose:function(){g(!1)}})]})},Se=function(e){e&&e instanceof Function&&i.e(3).then(i.bind(null,241)).then((function(t){var i=t.getCLS,n=t.getFID,a=t.getFCP,c=t.getLCP,r=t.getTTFB;i(e),n(e),a(e),c(e),r(e)}))};r.a.render(Object(G.jsxs)(a.a.StrictMode,{children:[Object(G.jsx)(l.a,{}),Object(G.jsx)(s.a,{children:Object(G.jsx)(Le,{})})]}),document.getElementById("root")),Se()}},[[176,1,2]]]);
//# sourceMappingURL=main.98725fa1.chunk.js.map