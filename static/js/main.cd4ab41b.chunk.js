(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{110:function(e,t,i){},166:function(e,t,i){"use strict";i.r(t);var n=i(0),a=i.n(n),c=i(11),r=i.n(c),l=(i(110),i(217)),s=i(17),o=i(204),u=i(216),d=i(219),b=i(169),j=i(20),m=i(92),h=i(206),p=i(209),O=i(208),g=i(210),f=i(81),x=(i(112),i(82)),v=i.n(x),w=1500,S=["video/webm","video/mpeg","audio/wav","audio/x-flac","audio/mpeg","audio/midi","audio/webm","application/ogg"],k=i(5),C=function(e){var t=e.split("/");return function(e){return e.split("?width")[0]}(t[t.length-1])},E=function(e){return e.length>150?"".concat(e.substr(0,50),"..."):e},L=Object(o.a)({root:{height:"fit-content",margin:j.isMobile?8:16,"& .MuiCardContent-root":{padding:8},"& .MuiCardActions-root":{padding:4}},title:{maxWidth:"fit-content",wordBreak:"break-all",fontSize:j.isMobile?12:14},media:{"& img":{objectFit:"cover !important"},"& img:hover":{cursor:"zoom-in !important"}},desc:{maxWidth:"fit-content",fontSize:j.isMobile?10:12}}),y=function(e){var t,i=e.data,n=i.thumb,a=i.fileLabel,c=i.file,r=i.encoding,l=i.fileOrig,s=i.itemLabel,o=e.onClick,u=void 0===o?function(){}:o,d=L();return Object(k.jsxs)(h.a,{className:d.root,children:[Object(k.jsx)("div",{className:d.media,children:S.includes(r.value)?Object(k.jsx)(v.a,{controls:!0,url:l.value,height:j.isMobile?94:169,width:j.isMobile?125:225}):Object(k.jsx)(f.LazyLoadImage,{onClick:u,alt:c.value,effect:"blur",src:n.value,height:j.isMobile?94:169,width:j.isMobile?125:225})}),Object(k.jsxs)(O.a,{children:[Object(k.jsx)(b.a,{className:d.title,gutterBottom:!0,children:(t=C(l.value),t.length>50?"".concat(t.substr(0,50),"..."):t)}),(null===a||void 0===a?void 0:a["xml:lang"])?Object(k.jsx)(b.a,{color:"textSecondary",className:d.desc,children:E(a.value)}):(null===s||void 0===s?void 0:s.value)&&Object(k.jsx)(b.a,{color:"textSecondary",className:d.desc,children:E(s.value)})]}),Object(k.jsx)(p.a,{children:Object(k.jsx)(g.a,{size:"small",color:"primary",href:c.value,target:"_blank",children:"Learn More"})})]})},N=i(48),I=i(65),M=i(87),A=i.n(M),P=i(218),W=i(221),R=i(88),T=i(89),U=function(){function e(t){Object(R.a)(this,e),this.endpoint=t}return Object(T.a)(e,[{key:"query",value:function(e){var t="".concat(this.endpoint,"?query=").concat(encodeURIComponent(e));return fetch(t,{headers:{Accept:"application/sparql-results+json"}}).then((function(e){return e.json()}))}}]),e}(),F=function(e){var t=e.onClick,i=e.option;return Object(k.jsxs)(d.a,{display:"flex",flexDirection:"column",onClick:t,children:[Object(k.jsx)(b.a,{children:i.label}),Object(k.jsx)(b.a,{variant:"caption",children:i.description})]})},q=i(90),z=i.n(q),B=i(213),D=i(220),G=i(215),H=i(222),V=i(211),_=i(223),J=i(212),K=Object(o.a)({root:{width:250},input:{width:50}}),Q=function(e){var t=e.mediaLimit,i=e.setMediaLimit,n=K();return Object(k.jsxs)("div",{className:n.root,children:[Object(k.jsx)(b.a,{id:"input-slider",gutterBottom:!0,children:"Media limit"}),Object(k.jsxs)(V.a,{container:!0,spacing:2,alignItems:"center",children:[Object(k.jsx)(V.a,{item:!0,xs:!0,children:Object(k.jsx)(_.a,{value:"number"===typeof t?t:0,onChange:function(e,t){return!(t>w)&&i(t)},"aria-labelledby":"input-slider",color:"secondary",min:10,max:w,step:10})}),Object(k.jsx)(V.a,{item:!0,children:Object(k.jsx)(J.a,{className:n.input,value:t,margin:"dense",onChange:function(e){return!(Number(e.target.value)>w)&&i(""===e.target.value?"":Number(e.target.value))},inputProps:{step:10,min:10,max:w,type:"number","aria-labelledby":"input-slider"}})})]})]})},X=Object(o.a)({popoverContent:{padding:"8px 16px","& .MuiFormControlLabel-labelPlacementStart":{margin:0}},sliderWrapper:{marginTop:16}}),Y=function(e){var t=e.setIncludeSubclassSearch,i=e.includeSubclassSearch,a=e.setMediaLimit,c=e.mediaLimit,r=Object(n.useState)(null),l=Object(s.a)(r,2),o=l[0],u=l[1],d=Boolean(o),b=d?"simple-popover":void 0,j=X();return Object(k.jsxs)("div",{children:[Object(k.jsx)(B.a,{size:"small","aria-describedby":b,onClick:function(e){u(e.currentTarget)},children:Object(k.jsx)(z.a,{})}),Object(k.jsx)(D.a,{id:b,open:d,anchorEl:o,onClose:function(){u(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(k.jsxs)("div",{className:j.popoverContent,children:[Object(k.jsx)(G.a,{value:"start",checked:i,onChange:function(e){t(e.target.checked)},control:Object(k.jsx)(H.a,{size:"small"}),label:"Include subclass search",labelPlacement:"start"}),Object(k.jsx)("div",{className:j.sliderWrapper,children:Object(k.jsx)(Q,{setMediaLimit:a,mediaLimit:c})})]})})]})},Z=A()({instance:"https://www.wikidata.org",sparqlEndpoint:"https://query.wikidata.org/sparql"}),$=Object(o.a)({root:{maxWidth:500,width:"100%",display:"flex",alignItems:"center"},autocomplete:{width:"100%"},searchSettingsWrapper:{marginRight:8}}),ee=function(e){var t=e.setNoResults,i=e.setEntityMediaResults,a=e.setResultsLoading,c=Object(n.useState)(!1),r=Object(s.a)(c,2),l=r[0],o=r[1],d=Object(n.useState)(null),b=Object(s.a)(d,2),m=b[0],h=b[1],p=Object(n.useState)(""),O=Object(s.a)(p,2),g=O[0],f=O[1],x=Object(n.useState)([]),v=Object(s.a)(x,2),w=v[0],S=v[1],C=Object(n.useState)(!0),E=Object(s.a)(C,2),L=E[0],y=E[1],M=Object(n.useState)(1e3),A=Object(s.a)(M,2),R=A[0],T=A[1],q=Object(n.useRef)(null),z=$();return Object(n.useEffect)((function(){if(!m)return!1;i([]),a(!0);var e=[],n="\n      SELECT ?file ?thumb ?fileOrig ?fileLabel ?encoding WHERE {\n        ?file wdt:P180 wd:".concat(m.id,' .\n        ?file schema:contentUrl ?url .\n        ?file schema:encodingFormat ?encoding .\n        SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }\n        bind(iri(concat("http://commons.wikimedia.org/wiki/Special:FilePath/", wikibase:decodeUri(substr(str(?url),53)), "?width=').concat(j.isMobile?100:200,'")) AS ?thumb)\n        bind(iri(concat("http://commons.wikimedia.org/wiki/Special:FilePath/", wikibase:decodeUri(substr(str(?url),53)))) AS ?fileOrig)\n      } limit ').concat(R,"\n    "),c=new U("https://wcqs-beta.wmflabs.org/sparql");return c.query(n).then((function(r){return e=e.concat(r.results.bindings),t(!1),i(Object(I.a)(e)),L?(e.length>0&&a(!1),n="\n        SELECT DISTINCT ?item ?itemLabel ?image ?file ?thumb ?fileOrig ?fileLabel ?encoding\n        WITH \n        { SELECT ?item ?itemLabel WHERE\n          { SERVICE <https://query.wikidata.org/sparql> \n            { ?item wdt:P31/wdt:P279* wd:".concat(m.id,' .\n              SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". ?item rdfs:label ?itemLabel .}\n            }\n          }\n        } AS %Wikidataitems\n  \n        WHERE {\n          INCLUDE %Wikidataitems .\n          ?file wdt:P180 ?item.\n          ?file schema:contentUrl ?url .\n          ?file schema:encodingFormat ?encoding .\n          SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }\n          bind(iri(concat("http://commons.wikimedia.org/wiki/Special:FilePath/", wikibase:decodeUri(substr(str(?url),53)), "?width=').concat(j.isMobile?100:200,'")) AS ?thumb)\n          bind(iri(concat("http://commons.wikimedia.org/wiki/Special:FilePath/", wikibase:decodeUri(substr(str(?url),53)))) AS ?fileOrig)\n        } limit ').concat(R,"\n      "),c.query(n).then((function(n){e=e.concat(n.results.bindings),i(Object(I.a)(e)),0===e.length&&t(!0),a(!1)})),!0):(0===e.length&&t(!0),a(!1),!0)})),!0}),[L,m]),Object(n.useEffect)((function(){if(""!==g)return q.current&&clearTimeout(q.current),q.current=setTimeout((function(){o(!0);var e=Z.searchEntities(g);fetch(e).then((function(e){return e.json()})).then((function(e){S(e.search),o(!1)}))}),500),!0;t(!1)}),[g,t]),Object(k.jsxs)("div",{className:z.root,children:[Object(k.jsx)("div",{className:z.searchSettingsWrapper,children:Object(k.jsx)(Y,{setIncludeSubclassSearch:y,includeSubclassSearch:L,setMediaLimit:T,mediaLimit:R})}),Object(k.jsx)(W.a,{clearOnBlur:!1,autoHighlight:!0,options:w,renderOption:function(e){return Object(k.jsx)(F,{option:e})},getOptionSelected:function(e,t){return e.title===t.title},getOptionLabel:function(e){return e.label},loading:l,filterOptions:function(e){return e},value:m,size:"small",onChange:function(e,t){h(t)},onInputChange:function(e,t){f(t)},className:z.autocomplete,renderInput:function(e){return Object(k.jsx)(P.a,Object(N.a)(Object(N.a)({},e),{},{label:"Search Commons...",variant:"outlined",InputProps:Object(N.a)(Object(N.a)({},e.InputProps),{},{endAdornment:Object(k.jsxs)(k.Fragment,{children:[l?Object(k.jsx)(u.a,{color:"inherit",size:20}):null,w.length>0?e.InputProps.endAdornment:null]})})}))}})]})},te=Object(o.a)({root:{padding:j.isMobile?"20px 10px":"25px 50px",display:"flex",flexDirection:"column",alignItems:"center"},inputWrapper:{marginBottom:8,width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},loadingWrapper:{position:"absolute",top:"50%"},count:{marginTop:8}}),ie=function(){var e=te(),t=Object(n.useState)([]),i=Object(s.a)(t,2),a=i[0],c=i[1],r=Object(n.useState)(!1),l=Object(s.a)(r,2),o=l[0],j=l[1],h=Object(n.useState)(!1),p=Object(s.a)(h,2),O=p[0],g=p[1],f=Object(n.useState)(!1),x=Object(s.a)(f,2),v=x[0],w=x[1];return console.log(a,"entityMediaResults"),Object(k.jsxs)("div",{className:e.root,children:[Object(k.jsxs)("div",{className:e.inputWrapper,children:[Object(k.jsx)(ee,{setNoResults:j,setEntityMediaResults:c,setResultsLoading:w}),a.length>0&&Object(k.jsx)("small",{className:e.count,children:"".concat(a.length," results")})]}),v&&Object(k.jsx)("div",{className:e.loadingWrapper,children:Object(k.jsx)(u.a,{})}),a.length>0&&Object(k.jsx)(d.a,{display:"flex",flexWrap:"wrap",justifyContent:"center",children:n.Children.toArray(a.map((function(e){return Object(k.jsx)(y,{data:e,onClick:function(){return g(e)}})})))}),o&&Object(k.jsx)(b.a,{children:"No results..."}),O&&Object(k.jsx)(m.a,{large:O.fileOrig.value,alt:O.file.value,onClose:function(){g(!1)}})]})},ne=function(e){e&&e instanceof Function&&i.e(3).then(i.bind(null,225)).then((function(t){var i=t.getCLS,n=t.getFID,a=t.getFCP,c=t.getLCP,r=t.getTTFB;i(e),n(e),a(e),c(e),r(e)}))};r.a.render(Object(k.jsxs)(a.a.StrictMode,{children:[Object(k.jsx)(l.a,{}),Object(k.jsx)(ie,{})]}),document.getElementById("root")),ne()}},[[166,1,2]]]);
//# sourceMappingURL=main.cd4ab41b.chunk.js.map