(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{106:function(e,t,n){},162:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),c=n(11),r=n.n(c),l=(n(106),n(209)),o=n(17),s=n(198),u=n(208),d=n(211),b=n(165),j=n(22),h=n(88),m=n(200),p=n(203),O=n(202),g=n(204),f=n(77),x=(n(108),n(78)),v=n.n(x),w=["video/webm","video/mpeg","audio/wav","audio/x-flac","audio/mpeg","audio/midi","audio/webm","application/ogg"],S=n(5),k=function(e){var t=e.split("/");return function(e){return e.split("?width")[0]}(t[t.length-1])},C=function(e){return e.length>150?"".concat(e.substr(0,50),"..."):e},E=Object(s.a)({root:{height:"fit-content",margin:16,"& .MuiCardContent-root":{padding:8},"& .MuiCardActions-root":{padding:4}},title:{maxWidth:"fit-content",wordBreak:"break-all",fontSize:j.isMobile?12:14},media:{"& img":{objectFit:"cover !important"},"& img:hover":{cursor:"zoom-in !important"}},desc:{maxWidth:"fit-content",fontSize:j.isMobile?10:12}}),L=function(e){var t,n=e.data,i=n.thumb,a=n.fileLabel,c=n.file,r=n.encoding,l=n.fileOrig,o=n.itemLabel,s=e.onClick,u=void 0===s?function(){}:s,d=E();return Object(S.jsxs)(m.a,{className:d.root,children:[Object(S.jsx)("div",{className:d.media,children:w.includes(r.value)?Object(S.jsx)(v.a,{controls:!0,url:l.value,height:j.isMobile?94:169,width:j.isMobile?125:225}):Object(S.jsx)(f.LazyLoadImage,{onClick:u,alt:c.value,effect:"blur",src:i.value,height:j.isMobile?94:169,width:j.isMobile?125:225})}),Object(S.jsxs)(O.a,{children:[Object(S.jsx)(b.a,{className:d.title,gutterBottom:!0,children:(t=k(l.value),t.length>50?"".concat(t.substr(0,50),"..."):t)}),(null===a||void 0===a?void 0:a["xml:lang"])?Object(S.jsx)(b.a,{color:"textSecondary",className:d.desc,children:C(a.value)}):(null===o||void 0===o?void 0:o.value)&&Object(S.jsx)(b.a,{color:"textSecondary",className:d.desc,children:C(o.value)})]}),Object(S.jsx)(p.a,{children:Object(S.jsx)(g.a,{size:"small",color:"primary",href:c.value,target:"_blank",children:"Learn More"})})]})},y=n(45),I=n(61),N=n(83),A=n.n(N),P=n(210),M=n(213),R=n(84),W=n(85),T=function(){function e(t){Object(R.a)(this,e),this.endpoint=t}return Object(W.a)(e,[{key:"query",value:function(e){var t="".concat(this.endpoint,"?query=").concat(encodeURIComponent(e));return fetch(t,{headers:{Accept:"application/sparql-results+json"}}).then((function(e){return e.json()}))}}]),e}(),U=function(e){var t=e.onClick,n=e.option;return Object(S.jsxs)(d.a,{display:"flex",flexDirection:"column",onClick:t,children:[Object(S.jsx)(b.a,{children:n.label}),Object(S.jsx)(b.a,{variant:"caption",children:n.description})]})},F=n(86),q=n.n(F),z=n(205),B=n(212),G=n(207),D=n(214),H=Object(s.a)({popoverContent:{padding:"8px 16px","& .MuiFormControlLabel-labelPlacementStart":{margin:0}}}),V=function(e){var t=e.setIncludeSubclassSearch,n=e.includeSubclassSearch,a=Object(i.useState)(null),c=Object(o.a)(a,2),r=c[0],l=c[1],s=Boolean(r),u=s?"simple-popover":void 0,d=H();return Object(S.jsxs)("div",{children:[Object(S.jsx)(z.a,{size:"small","aria-describedby":u,onClick:function(e){l(e.currentTarget)},children:Object(S.jsx)(q.a,{})}),Object(S.jsx)(B.a,{id:u,open:s,anchorEl:r,onClose:function(){l(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(S.jsx)("div",{className:d.popoverContent,children:Object(S.jsx)(G.a,{value:"start",checked:n,onChange:function(e){t(e.target.checked)},control:Object(S.jsx)(D.a,{size:"small"}),label:"Include subclass search",labelPlacement:"start"})})})]})},_=A()({instance:"https://www.wikidata.org",sparqlEndpoint:"https://query.wikidata.org/sparql"}),J=Object(s.a)({root:{maxWidth:500,width:"100%",display:"flex",alignItems:"center",margin:"0 auto"},autocomplete:{width:"100%"},searchSettingsWrapper:{marginRight:8}}),K=function(e){var t=e.setNoResults,n=e.setEntityMediaResults,a=e.setResultsLoading,c=Object(i.useState)(!1),r=Object(o.a)(c,2),l=r[0],s=r[1],d=Object(i.useState)(null),b=Object(o.a)(d,2),h=b[0],m=b[1],p=Object(i.useState)(""),O=Object(o.a)(p,2),g=O[0],f=O[1],x=Object(i.useState)([]),v=Object(o.a)(x,2),w=v[0],k=v[1],C=Object(i.useState)(!0),E=Object(o.a)(C,2),L=E[0],N=E[1],A=Object(i.useRef)(null),R=J(),W=Object(i.useCallback)((function(e){if(!e)return!1;n([]),a(!0);var i=[],c="\n      SELECT ?file ?thumb ?fileOrig ?fileLabel ?encoding WHERE {\n        ?file wdt:P180 wd:".concat(e.id,' .\n        ?file schema:contentUrl ?url .\n        ?file schema:encodingFormat ?encoding .\n        SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }\n        bind(iri(concat("http://commons.wikimedia.org/wiki/Special:FilePath/", wikibase:decodeUri(substr(str(?url),53)), "?width=').concat(j.isMobile?100:200,'")) AS ?thumb)\n        bind(iri(concat("http://commons.wikimedia.org/wiki/Special:FilePath/", wikibase:decodeUri(substr(str(?url),53)))) AS ?fileOrig)\n      } limit ').concat(1e3,"\n    "),r=new T("https://wcqs-beta.wmflabs.org/sparql");return r.query(c).then((function(l){return i=i.concat(l.results.bindings),t(!1),n(Object(I.a)(i)),L?(i.length>0&&a(!1),c="\n        SELECT DISTINCT ?item ?itemLabel ?image ?file ?thumb ?fileOrig ?fileLabel ?encoding\n        WITH \n        { SELECT ?item ?itemLabel WHERE\n          { SERVICE <https://query.wikidata.org/sparql> \n            { ?item wdt:P31/wdt:P279* wd:".concat(e.id,' .\n              SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". ?item rdfs:label ?itemLabel .}\n            }\n          }\n        } AS %Wikidataitems\n  \n        WHERE {\n          INCLUDE %Wikidataitems .\n          ?file wdt:P180 ?item.\n          ?file schema:contentUrl ?url .\n          ?file schema:encodingFormat ?encoding .\n          SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }\n          bind(iri(concat("http://commons.wikimedia.org/wiki/Special:FilePath/", wikibase:decodeUri(substr(str(?url),53)), "?width=').concat(j.isMobile?100:200,'")) AS ?thumb)\n          bind(iri(concat("http://commons.wikimedia.org/wiki/Special:FilePath/", wikibase:decodeUri(substr(str(?url),53)))) AS ?fileOrig)\n        } limit ').concat(1e3,"\n      "),r.query(c).then((function(e){i=i.concat(e.results.bindings),n(Object(I.a)(i)),0===i.length&&t(!0),a(!1)})),!0):(0===i.length&&t(!0),a(!1),!0)})),!0}),[L,n,t,a]);return Object(i.useEffect)((function(){W(h)}),[L,h,W]),Object(i.useEffect)((function(){if(""!==g)return A.current&&clearTimeout(A.current),A.current=setTimeout((function(){s(!0);var e=_.searchEntities(g);fetch(e).then((function(e){return e.json()})).then((function(e){k(e.search),s(!1)}))}),500),!0;t(!1)}),[g,t]),Object(S.jsxs)("div",{className:R.root,children:[Object(S.jsx)("div",{className:R.searchSettingsWrapper,children:Object(S.jsx)(V,{setIncludeSubclassSearch:N,includeSubclassSearch:L})}),Object(S.jsx)(M.a,{clearOnBlur:!1,autoHighlight:!0,options:w,renderOption:function(e){return Object(S.jsx)(U,{option:e})},getOptionSelected:function(e,t){return e.title===t.title},getOptionLabel:function(e){return e.label},loading:l,filterOptions:function(e){return e},value:h,size:"small",onChange:function(e,t){m(t)},onInputChange:function(e,t){f(t)},className:R.autocomplete,renderInput:function(e){return Object(S.jsx)(P.a,Object(y.a)(Object(y.a)({},e),{},{label:"Search Commons...",variant:"outlined",InputProps:Object(y.a)(Object(y.a)({},e.InputProps),{},{endAdornment:Object(S.jsxs)(S.Fragment,{children:[l?Object(S.jsx)(u.a,{color:"inherit",size:20}):null,w.length>0?e.InputProps.endAdornment:null]})})}))}})]})},Q=Object(s.a)({root:{padding:j.isMobile?"10px":"25px 50px",display:"flex",flexDirection:"column",alignItems:"center"},inputWrapper:{marginBottom:16,width:"100%"},loadingWrapper:{position:"absolute",top:"50%"}}),X=function(){var e=Q(),t=Object(i.useState)([]),n=Object(o.a)(t,2),a=n[0],c=n[1],r=Object(i.useState)(!1),l=Object(o.a)(r,2),s=l[0],j=l[1],m=Object(i.useState)(!1),p=Object(o.a)(m,2),O=p[0],g=p[1],f=Object(i.useState)(!1),x=Object(o.a)(f,2),v=x[0],w=x[1];return console.log(a,"entityMediaResults"),Object(S.jsxs)("div",{className:e.root,children:[Object(S.jsx)("div",{className:e.inputWrapper,children:Object(S.jsx)(K,{setNoResults:j,setEntityMediaResults:c,setResultsLoading:w})}),v&&Object(S.jsx)("div",{className:e.loadingWrapper,children:Object(S.jsx)(u.a,{})}),a.length>0&&Object(S.jsx)(d.a,{display:"flex",flexWrap:"wrap",justifyContent:"center",children:i.Children.toArray(a.map((function(e){return Object(S.jsx)(L,{data:e,onClick:function(){return g(e)}})})))}),s&&Object(S.jsx)(b.a,{children:"No results..."}),O&&Object(S.jsx)(h.a,{large:O.fileOrig.value,alt:O.file.value,onClose:function(){g(!1)}})]})},Y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,216)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),i(e),a(e),c(e),r(e)}))};r.a.render(Object(S.jsxs)(a.a.StrictMode,{children:[Object(S.jsx)(l.a,{}),Object(S.jsx)(X,{})]}),document.getElementById("root")),Y()}},[[162,1,2]]]);
//# sourceMappingURL=main.19ad5bc3.chunk.js.map