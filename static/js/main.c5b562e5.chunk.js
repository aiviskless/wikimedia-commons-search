(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{116:function(e,t,i){},169:function(e,t,i){"use strict";i.r(t);var n=i(0),a=i.n(n),c=i(13),r=i.n(c),l=(i(116),i(224)),o=i(17),s=i(210),u=i(222),d=i(226),b=i(172),m=i(21),p=i(99),j=i(212),g=i(215),h=i(214),f=i(216),O=i(86),x=(i(118),i(87)),v=i.n(x),w=i(92),S=i.n(w),C=1500,k=["video/webm","video/mpeg","audio/wav","audio/x-flac","audio/mpeg","audio/midi","audio/webm","application/ogg"],L=["jpg","jpeg","jpe","jif","jfif","png","gif","webp","tiff","psd","raw","svg","pdf"],N=["webm","mpg","mpeg","mpe","mpv","ogv","mp4","m4p","m4v","avi","wmv","mov","qt","flv"],y=["m4a","flac","mp3","wav","wma","aac","ogg","midi"],E=function(e){return e.split("?width")[0]},I=function(e){var t=e.split("/");return E(t[t.length-1])},P=i(5),M=function(e){return e.length>150?"".concat(e.substr(0,50),"..."):e},T=Object(s.a)({root:{height:"fit-content",margin:m.isMobile?8:16,"& .MuiCardContent-root":{padding:8},"& .MuiCardActions-root":{padding:4}},title:{maxWidth:"fit-content",wordBreak:"break-all",fontSize:m.isMobile?12:14},media:{"& img":{objectFit:"cover !important"},"& img:hover":{cursor:"zoom-in !important"}},desc:{maxWidth:"fit-content",fontSize:m.isMobile?10:12,marginBottom:8},creatorWrapper:{display:"flex",alignItems:"center","& svg":{display:"flex",alignItems:"center",fontSize:20,color:"gray",transform:"translateY(-2px)",marginRight:4}}}),A=function(e){var t,i=e.data,n=i.thumb,a=i.fileLabel,c=i.file,r=i.encoding,l=i.fileOrig,o=i.itemLabel,s=i.creator,u=i.creatorUploadCount,d=e.onClick,p=void 0===d?function(){}:d,x=T();return Object(P.jsxs)(j.a,{className:x.root,children:[Object(P.jsx)("div",{className:x.media,children:k.includes(r.value)?Object(P.jsx)(v.a,{controls:!0,url:l.value,height:m.isMobile?94:169,width:m.isMobile?125:225}):Object(P.jsx)(O.LazyLoadImage,{onClick:p,alt:c.value,effect:"blur",src:n.value,height:m.isMobile?94:169,width:m.isMobile?125:225})}),Object(P.jsxs)(h.a,{children:[Object(P.jsx)(b.a,{className:x.title,gutterBottom:!0,children:(t=I(l.value),t.length>50?"".concat(t.substr(0,50),"..."):t)}),(null===a||void 0===a?void 0:a["xml:lang"])?Object(P.jsx)(b.a,{color:"textSecondary",className:x.desc,children:M(a.value)}):(null===o||void 0===o?void 0:o.value)&&Object(P.jsx)(b.a,{color:"textSecondary",className:x.desc,children:M(o.value)}),s&&Object(P.jsxs)("div",{className:x.creatorWrapper,children:[Object(P.jsx)(S.a,{}),Object(P.jsx)(b.a,{color:"textSecondary",variant:"caption",children:"".concat(s.value," (").concat((null===u||void 0===u?void 0:u.value)||"?",")")})]})]}),Object(P.jsx)(g.a,{children:Object(P.jsx)(f.a,{size:"small",color:"primary",href:c.value,target:"_blank",children:"Learn More"})})]})},W=i(51),R=i(70),U=i(69),z=i.n(U),q=i(225),F=i(229),B=function(e){var t=e.onClick,i=e.option;return Object(P.jsxs)(d.a,{display:"flex",flexDirection:"column",onClick:t,children:[Object(P.jsx)(b.a,{children:i.label}),Object(P.jsx)(b.a,{variant:"caption",children:i.description})]})},D=i(93),H=i.n(D),G=i(219),V=i(227),_=i(221),J=i(230),Q=i(217),Y=i(231),K=i(218),X=Object(s.a)({root:{width:250},input:{width:50}}),Z=function(e){var t=e.mediaLimit,i=e.setMediaLimit,n=X();return Object(P.jsxs)("div",{className:n.root,children:[Object(P.jsx)(b.a,{id:"input-slider",gutterBottom:!0,children:"Media limit"}),Object(P.jsxs)(Q.a,{container:!0,spacing:2,alignItems:"center",children:[Object(P.jsx)(Q.a,{item:!0,xs:!0,children:Object(P.jsx)(Y.a,{value:"number"===typeof t?t:0,onChange:function(e,t){return!(t>C)&&i(t)},"aria-labelledby":"input-slider",color:"secondary",min:10,max:C,step:10})}),Object(P.jsx)(Q.a,{item:!0,children:Object(P.jsx)(K.a,{className:n.input,value:t,margin:"dense",onChange:function(e){return!(Number(e.target.value)>C)&&i(""===e.target.value?"":Number(e.target.value))},inputProps:{step:10,min:10,max:C,type:"number","aria-labelledby":"input-slider"}})})]})]})},$=Object(s.a)({popoverContent:{padding:"8px 16px","& .MuiFormControlLabel-labelPlacementStart":{margin:0}},sliderWrapper:{marginTop:16}}),ee=function(e){var t=e.setIncludeSubclassSearch,i=e.includeSubclassSearch,a=e.setMediaLimit,c=e.mediaLimit,r=Object(n.useState)(null),l=Object(o.a)(r,2),s=l[0],u=l[1],d=Boolean(s),b=d?"simple-popover":void 0,m=$();return Object(P.jsxs)("div",{children:[Object(P.jsx)(G.a,{size:"small","aria-describedby":b,onClick:function(e){u(e.currentTarget)},children:Object(P.jsx)(H.a,{})}),Object(P.jsx)(V.a,{id:b,open:d,anchorEl:s,onClose:function(){u(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(P.jsxs)("div",{className:m.popoverContent,children:[Object(P.jsx)(_.a,{value:"start",checked:i,onChange:function(e){t(e.target.checked)},control:Object(P.jsx)(J.a,{size:"small"}),label:"Include subclass search",labelPlacement:"start"}),Object(P.jsx)("div",{className:m.sliderWrapper,children:Object(P.jsx)(Z,{setMediaLimit:a,mediaLimit:c})})]})})]})},te=z()({instance:"https://www.wikidata.org",sparqlEndpoint:"https://query.wikidata.org/sparql"}),ie=z()({instance:"https://commons.wikimedia.org/",sparqlEndpoint:"https://wcqs-beta.wmflabs.org/sparql"}),ne=Object(s.a)({root:{maxWidth:500,width:"100%",display:"flex",alignItems:"center"},autocomplete:{width:"100%"},searchSettingsWrapper:{marginRight:8}}),ae=function(e){var t=e.setNoResults,i=e.setEntityMediaResults,a=e.setResultsLoading,c=Object(n.useState)(!1),r=Object(o.a)(c,2),l=r[0],s=r[1],d=Object(n.useState)(null),b=Object(o.a)(d,2),p=b[0],j=b[1],g=Object(n.useState)(""),h=Object(o.a)(g,2),f=h[0],O=h[1],x=Object(n.useState)([]),v=Object(o.a)(x,2),w=v[0],S=v[1],C=Object(n.useState)(!0),k=Object(o.a)(C,2),L=k[0],N=k[1],y=Object(n.useState)(1e3),E=Object(o.a)(y,2),I=E[0],M=E[1],T=Object(n.useRef)(null),A=ne();return Object(n.useEffect)((function(){if(!p)return!1;i([]),a(!0);var e,n=[],c='\n      SELECT ?file ?thumb ?fileOrig ?fileLabel ?encoding ?creator (COUNT(?files) as ?creatorUploadCount) (group_concat(?depictLabel;separator="/") as ?depicts) WHERE {\n        ?file wdt:P180 wd:'.concat(p.id,' .\n        ?file schema:contentUrl ?url .\n        ?file schema:encodingFormat ?encoding .\n        \n        OPTIONAL { \n          ?file wdt:P180 ?depict .\n          ?file p:P170/pq:P4174 ?creator .\n          ?files p:P170/pq:P4174 ?creator .\n        }\n        \n        SERVICE wikibase:label {\n          bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en".\n          ?depict rdfs:label ?depictLabel .\n        }\n        bind(iri(concat("http://commons.wikimedia.org/wiki/Special:FilePath/", wikibase:decodeUri(substr(str(?url),53)), "?width=').concat(m.isMobile?100:200,'")) AS ?thumb)\n        bind(iri(concat("http://commons.wikimedia.org/wiki/Special:FilePath/", wikibase:decodeUri(substr(str(?url),53)))) AS ?fileOrig)\n      } group by ?file ?thumb ?fileOrig ?fileLabel ?encoding ?creator limit ').concat(I,"\n    ");return e=ie.sparqlQuery(c),fetch(e).then((function(e){return e.json()})).then((function(r){return n=n.concat(r.results.bindings),t(!1),i(Object(R.a)(n)),L?(n.length>0&&a(!1),c="\n        SELECT DISTINCT ?item ?itemLabel ?image ?file ?thumb ?fileOrig ?fileLabel ?encoding ?creator WITH { \n          SELECT ?item ?itemLabel WHERE {\n            SERVICE <https://query.wikidata.org/sparql> {\n              ?item wdt:P31/wdt:P279* wd:".concat(p.id,' .\n              SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". ?item rdfs:label ?itemLabel . }\n            }\n          }\n        } AS %Wikidataitems\n  \n        WHERE {\n          INCLUDE %Wikidataitems .\n          ?file wdt:P180 ?item.\n          ?file schema:contentUrl ?url .\n          ?file schema:encodingFormat ?encoding .\n\n          OPTIONAL {\n            ?file p:P170/pq:P4174 ?creator .\n          }\n\n          SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }\n          bind(iri(concat("http://commons.wikimedia.org/wiki/Special:FilePath/", wikibase:decodeUri(substr(str(?url),53)), "?width=').concat(m.isMobile?100:200,'")) AS ?thumb)\n          bind(iri(concat("http://commons.wikimedia.org/wiki/Special:FilePath/", wikibase:decodeUri(substr(str(?url),53)))) AS ?fileOrig)\n        } limit ').concat(I,"\n      "),e=ie.sparqlQuery(c),fetch(e).then((function(e){return e.json()})).then((function(e){n=n.concat(e.results.bindings),i(Object(R.a)(n)),0===n.length&&t(!0),a(!1)})),!0):(0===n.length&&t(!0),a(!1),!0)})),!0}),[L,p]),Object(n.useEffect)((function(){if(""!==f)return T.current&&clearTimeout(T.current),T.current=setTimeout((function(){s(!0);var e=te.searchEntities(f);fetch(e).then((function(e){return e.json()})).then((function(e){S(e.search),s(!1)}))}),500),!0;t(!1)}),[f,t]),Object(P.jsxs)("div",{className:A.root,children:[Object(P.jsx)("div",{className:A.searchSettingsWrapper,children:Object(P.jsx)(ee,{setIncludeSubclassSearch:N,includeSubclassSearch:L,setMediaLimit:M,mediaLimit:I})}),Object(P.jsx)(F.a,{clearOnBlur:!1,autoHighlight:!0,options:w,renderOption:function(e){return Object(P.jsx)(B,{option:e})},getOptionSelected:function(e,t){return e.title===t.title},getOptionLabel:function(e){return e.label},loading:l,filterOptions:function(e){return e},value:p,size:"small",onChange:function(e,t){j(t)},onInputChange:function(e,t){O(t)},className:A.autocomplete,renderInput:function(e){return Object(P.jsx)(q.a,Object(W.a)(Object(W.a)({},e),{},{label:"Search Commons...",variant:"outlined",InputProps:Object(W.a)(Object(W.a)({},e.InputProps),{},{endAdornment:Object(P.jsxs)(P.Fragment,{children:[l?Object(P.jsx)(u.a,{color:"inherit",size:20}):null,w.length>0?e.InputProps.endAdornment:null]})})}))}})]})},ce=i(228),re=i(223),le=i(98),oe=i.n(le),se=i(97),ue=i.n(se),de=i(96),be=i.n(de),me=i(95),pe=i.n(me),je=Object(s.a)({root:{minHeight:36},tab:{padding:0,minHeight:32,minWidth:85,fontSize:12,textTransform:"capitalize","& .MuiTab-wrapper":{flexDirection:"row","& .MuiSvgIcon-root":{margin:"0 4px 0 0"}}},icon:{fontSize:20}}),ge=function(e){var t=e.setTab,i=e.tab,n=je(),a=[{label:"All",icon:Object(P.jsx)(pe.a,{className:n.icon})},{label:"Images",icon:Object(P.jsx)(be.a,{className:n.icon})},{label:"Video",icon:Object(P.jsx)(ue.a,{className:n.icon})},{label:"Audio",icon:Object(P.jsx)(oe.a,{className:n.icon})}];return Object(P.jsx)(ce.a,{value:i,indicatorColor:"primary",textColor:"primary",onChange:function(e,i){t(i)},className:n.root,children:a.map((function(e){var t=e.label,i=e.icon;return Object(P.jsx)(re.a,{className:n.tab,label:t,icon:i},t)}))})},he=function(e){var t=e.split(".");return t[t.length-1]},fe=Object(s.a)({root:{padding:m.isMobile?"20px 10px":"25px 50px",display:"flex",flexDirection:"column",alignItems:"center"},inputWrapper:{marginBottom:8,width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},loadingWrapper:{position:"absolute",top:"50%"},count:{marginTop:12},wrapper:{marginTop:12,display:"flex",flexDirection:"column",alignItems:"center"}}),Oe=function(){var e=fe(),t=Object(n.useState)([]),i=Object(o.a)(t,2),a=i[0],c=i[1],r=Object(n.useState)(!1),l=Object(o.a)(r,2),s=l[0],m=l[1],j=Object(n.useState)(!1),g=Object(o.a)(j,2),h=g[0],f=g[1],O=Object(n.useState)(!1),x=Object(o.a)(O,2),v=x[0],w=x[1],S=Object(n.useState)(0),C=Object(o.a)(S,2),k=C[0],E=C[1],M=function(){var e=function(e,t){return e.filter((function(e){return t.includes(he(I(e.fileOrig.value)))||t.includes(he(I(e.fileOrig.value.toLowerCase())))}))};switch(k){case 1:return e(a,L);case 2:return e(a,N);case 3:return e(a,y);default:return a}}();return console.log(a,"entityMediaResults"),console.log(M),Object(P.jsxs)("div",{className:e.root,children:[Object(P.jsxs)("div",{className:e.inputWrapper,children:[Object(P.jsx)(ae,{setNoResults:m,setEntityMediaResults:c,setResultsLoading:w}),a.length>0&&Object(P.jsxs)("div",{className:e.wrapper,children:[Object(P.jsx)(ge,{setTab:E,tab:k}),Object(P.jsx)("small",{className:e.count,children:"".concat(M.length," results")})]})]}),v&&Object(P.jsx)("div",{className:e.loadingWrapper,children:Object(P.jsx)(u.a,{})}),M.length>0&&Object(P.jsx)(d.a,{display:"flex",flexWrap:"wrap",justifyContent:"center",children:n.Children.toArray(M.map((function(e){return Object(P.jsx)(A,{data:e,onClick:function(){return f(e)}})})))}),s&&Object(P.jsx)(b.a,{children:"No results..."}),h&&Object(P.jsx)(p.a,{large:h.fileOrig.value,alt:h.file.value,onClose:function(){f(!1)}})]})},xe=function(e){e&&e instanceof Function&&i.e(3).then(i.bind(null,233)).then((function(t){var i=t.getCLS,n=t.getFID,a=t.getFCP,c=t.getLCP,r=t.getTTFB;i(e),n(e),a(e),c(e),r(e)}))};r.a.render(Object(P.jsxs)(a.a.StrictMode,{children:[Object(P.jsx)(l.a,{}),Object(P.jsx)(Oe,{})]}),document.getElementById("root")),xe()}},[[169,1,2]]]);
//# sourceMappingURL=main.c5b562e5.chunk.js.map