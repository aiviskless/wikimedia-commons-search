{"version":3,"sources":["consts.js","components/MediaBox.jsx","utils/SPARQLQueryDispatcher.js","components/SearchResultOption.jsx","components/SearchSettings.jsx","components/Input.jsx","App.jsx","reportWebVitals.js","index.jsx"],"names":["NOT_IMAGE_ENCODINGS","getImageFilenameFromWDCFilePath","url","splitUrl","split","getFullsizeImage","length","formatDesc","desc","substr","useStyles","makeStyles","root","height","margin","padding","title","maxWidth","wordBreak","fontSize","isMobile","media","objectFit","cursor","MediaBox","data","thumb","fileLabel","file","encoding","fileOrig","itemLabel","onClick","classes","Card","className","includes","value","controls","width","alt","effect","src","CardContent","Typography","gutterBottom","color","CardActions","Button","size","href","target","SPARQLQueryDispatcher","endpoint","this","sparqlQuery","fullUrl","encodeURIComponent","fetch","headers","Accept","then","body","json","SearchResultOption","option","Box","display","flexDirection","label","variant","description","popoverContent","SearchSettings","setIncludeSubclassSearch","includeSubclassSearch","useState","anchorEl","setAnchorEl","open","Boolean","id","undefined","IconButton","aria-describedby","event","currentTarget","Popover","onClose","anchorOrigin","vertical","horizontal","transformOrigin","FormControlLabel","checked","onChange","control","Checkbox","labelPlacement","wdk","WBK","instance","sparqlEndpoint","alignItems","autocomplete","searchSettingsWrapper","marginRight","Input","setNoResults","setEntityMediaResults","setResultsLoading","loading","setLoading","setValue","inputValue","setInputValue","inputSearchResults","setInputSearchResults","timer","useRef","searchCommons","useCallback","valueToSearch","newEntityMediaResults","queryDispatcher","query","concat","results","bindings","useEffect","current","clearTimeout","setTimeout","searchEntities","response","search","Autocomplete","clearOnBlur","autoHighlight","options","renderOption","getOptionSelected","getOptionLabel","filterOptions","x","newValue","onInputChange","newInputValue","renderInput","params","TextField","InputProps","endAdornment","CircularProgress","inputWrapper","marginBottom","loadingWrapper","position","top","count","marginTop","App","entityMediaResults","noResults","selectedImage","setSelectedImage","console","log","flexWrap","justifyContent","Children","toArray","map","result","large","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","CssBaseline","document","getElementById"],"mappings":"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","file":"static/js/main.aacf3d95.chunk.js","sourcesContent":["export const TIMEOUT_FOR_SEARCH = 500;\r\nexport const MEDIA_LIMIT = 1000;\r\nexport const MEDIA_LIMIT_IN_PAGE = 100;\r\nexport const WCQS_ENDPOINT = 'https://wcqs-beta.wmflabs.org/sparql';\r\n\r\nexport const NOT_IMAGE_ENCODINGS = [\r\n  'video/webm',\r\n  'video/mpeg',\r\n  'audio/wav',\r\n  'audio/x-flac',\r\n  'audio/mpeg',\r\n  'audio/midi',\r\n  'audio/webm',\r\n  'application/ogg',\r\n];\r\n","import React from 'react';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport Button from '@material-ui/core/Button';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { makeStyles } from '@material-ui/core';\r\nimport { LazyLoadImage } from 'react-lazy-load-image-component';\r\nimport 'react-lazy-load-image-component/src/effects/blur.css';\r\nimport { isMobile } from 'react-device-detect';\r\nimport ReactPlayer from 'react-player';\r\nimport { NOT_IMAGE_ENCODINGS } from '../consts';\r\n\r\nconst getFullsizeImage = (url) => url.split('?width')[0];\r\n\r\nconst getImageFilenameFromWDCFilePath = (url) => {\r\n  const splitUrl = url.split('/');\r\n\r\n  return getFullsizeImage(splitUrl[splitUrl.length - 1]);\r\n};\r\n\r\nconst formatTitle = (title) => {\r\n  if (title.length > 50) return `${title.substr(0, 50)}...`;\r\n  return title;\r\n};\r\n\r\nconst formatDesc = (desc) => {\r\n  if (desc.length > 150) return `${desc.substr(0, 50)}...`;\r\n  return desc;\r\n};\r\n\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    height: 'fit-content',\r\n    margin: 16,\r\n\r\n    '& .MuiCardContent-root': {\r\n      padding: 8,\r\n    },\r\n\r\n    '& .MuiCardActions-root': {\r\n      padding: 4,\r\n    },\r\n  },\r\n\r\n  title: {\r\n    maxWidth: 'fit-content',\r\n    wordBreak: 'break-all',\r\n    fontSize: isMobile ? 12 : 14,\r\n  },\r\n\r\n  media: {\r\n    '& img': {\r\n      objectFit: 'cover !important',\r\n    },\r\n\r\n    '& img:hover': {\r\n      cursor: 'zoom-in !important',\r\n    },\r\n  },\r\n\r\n  desc: {\r\n    maxWidth: 'fit-content',\r\n    fontSize: isMobile ? 10 : 12,\r\n  },\r\n});\r\n\r\nconst MediaBox = ({\r\n  data: {\r\n    thumb, fileLabel, file, encoding, fileOrig, itemLabel,\r\n  },\r\n  onClick = () => {},\r\n}) => {\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <Card className={classes.root}>\r\n      <div className={classes.media}>\r\n        {NOT_IMAGE_ENCODINGS.includes(encoding.value) ? (\r\n          <ReactPlayer\r\n            controls\r\n            url={fileOrig.value}\r\n            height={isMobile ? 94 : 169}\r\n            width={isMobile ? 125 : 225}\r\n          />\r\n        ) : (\r\n          <LazyLoadImage\r\n            onClick={onClick}\r\n            alt={file.value}\r\n            effect=\"blur\"\r\n            src={thumb.value}\r\n            height={isMobile ? 94 : 169}\r\n            width={isMobile ? 125 : 225}\r\n          />\r\n        )}\r\n      </div>\r\n\r\n      <CardContent>\r\n        <Typography className={classes.title} gutterBottom>\r\n          {formatTitle(getImageFilenameFromWDCFilePath(fileOrig.value))}\r\n        </Typography>\r\n\r\n        {fileLabel?.['xml:lang'] ? (\r\n          <Typography\r\n            color=\"textSecondary\"\r\n            className={classes.desc}\r\n          >\r\n            {formatDesc(fileLabel.value)}\r\n          </Typography>\r\n        )\r\n          // show Wikidata item description if file description unavailable\r\n          : itemLabel?.value && (\r\n            <Typography\r\n              color=\"textSecondary\"\r\n              className={classes.desc}\r\n            >\r\n              {formatDesc(itemLabel.value)}\r\n            </Typography>\r\n          )}\r\n      </CardContent>\r\n\r\n      <CardActions>\r\n        <Button\r\n          size=\"small\"\r\n          color=\"primary\"\r\n          href={file.value}\r\n          target=\"_blank\"\r\n        >\r\n          Learn More\r\n        </Button>\r\n      </CardActions>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default MediaBox;\r\n","class SPARQLQueryDispatcher {\r\n  constructor(endpoint) {\r\n    this.endpoint = endpoint;\r\n  }\r\n\r\n  query(sparqlQuery) {\r\n    const fullUrl = `${this.endpoint}?query=${encodeURIComponent(sparqlQuery)}`;\r\n    const headers = { Accept: 'application/sparql-results+json' };\r\n\r\n    return fetch(fullUrl, { headers }).then((body) => body.json());\r\n  }\r\n}\r\n\r\nexport default SPARQLQueryDispatcher;\r\n","import { Box, Typography } from '@material-ui/core';\r\nimport React from 'react';\r\n\r\nconst SearchResultOption = ({ onClick, option }) => (\r\n  <Box display=\"flex\" flexDirection=\"column\" onClick={onClick}>\r\n    <Typography>{option.label}</Typography>\r\n    <Typography variant=\"caption\">{option.description}</Typography>\r\n  </Box>\r\n);\r\n\r\nexport default SearchResultOption;\r\n","import React, { useState } from 'react';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\nimport {\r\n  Checkbox, FormControlLabel, IconButton, makeStyles, Popover,\r\n} from '@material-ui/core';\r\n\r\nconst useStyles = makeStyles({\r\n  popoverContent: {\r\n    padding: '8px 16px',\r\n\r\n    '& .MuiFormControlLabel-labelPlacementStart': {\r\n      margin: 0,\r\n    },\r\n  },\r\n});\r\n\r\nconst SearchSettings = ({\r\n  setIncludeSubclassSearch,\r\n  includeSubclassSearch,\r\n}) => {\r\n  const [anchorEl, setAnchorEl] = useState(null);\r\n\r\n  const handleClick = (event) => {\r\n    setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  const handleChange = (event) => {\r\n    setIncludeSubclassSearch(event.target.checked);\r\n  };\r\n\r\n  const open = Boolean(anchorEl);\r\n  const id = open ? 'simple-popover' : undefined;\r\n\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <div>\r\n      <IconButton\r\n        size=\"small\"\r\n        aria-describedby={id}\r\n        onClick={handleClick}\r\n      >\r\n        <SettingsIcon />\r\n      </IconButton>\r\n      <Popover\r\n        id={id}\r\n        open={open}\r\n        anchorEl={anchorEl}\r\n        onClose={handleClose}\r\n        anchorOrigin={{\r\n          vertical: 'bottom',\r\n          horizontal: 'center',\r\n        }}\r\n        transformOrigin={{\r\n          vertical: 'top',\r\n          horizontal: 'center',\r\n        }}\r\n      >\r\n        <div className={classes.popoverContent}>\r\n          <FormControlLabel\r\n            value=\"start\"\r\n            checked={includeSubclassSearch}\r\n            onChange={handleChange}\r\n            control={<Checkbox size=\"small\" />}\r\n            label=\"Include subclass search\"\r\n            labelPlacement=\"start\"\r\n          />\r\n        </div>\r\n      </Popover>\r\n    </div>\r\n\r\n  );\r\n};\r\n\r\nexport default SearchSettings;\r\n","import React, {\r\n  useEffect,\r\n  useRef,\r\n  useState,\r\n  useCallback,\r\n} from 'react';\r\nimport WBK from 'wikibase-sdk';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Autocomplete from '@material-ui/lab/Autocomplete';\r\nimport {\r\n  CircularProgress, makeStyles,\r\n} from '@material-ui/core';\r\nimport { isMobile } from 'react-device-detect';\r\nimport SPARQLQueryDispatcher from '../utils/SPARQLQueryDispatcher';\r\nimport SearchResultOption from './SearchResultOption';\r\nimport {\r\n  MEDIA_LIMIT, TIMEOUT_FOR_SEARCH, WCQS_ENDPOINT,\r\n} from '../consts';\r\nimport SearchSettings from './SearchSettings';\r\n\r\nconst wdk = WBK({\r\n  instance: 'https://www.wikidata.org',\r\n  sparqlEndpoint: 'https://query.wikidata.org/sparql',\r\n});\r\n\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    maxWidth: 500,\r\n    width: '100%',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n  },\r\n\r\n  autocomplete: {\r\n    width: '100%',\r\n  },\r\n\r\n  searchSettingsWrapper: {\r\n    marginRight: 8,\r\n  },\r\n});\r\n\r\nconst Input = ({ setNoResults, setEntityMediaResults, setResultsLoading }) => {\r\n  const [loading, setLoading] = useState(false);\r\n  const [value, setValue] = useState(null);\r\n  const [inputValue, setInputValue] = useState('');\r\n  const [inputSearchResults, setInputSearchResults] = useState([]);\r\n\r\n  // settings\r\n  const [includeSubclassSearch, setIncludeSubclassSearch] = useState(true);\r\n\r\n  const timer = useRef(null);\r\n\r\n  const classes = useStyles();\r\n\r\n  const searchCommons = useCallback((valueToSearch) => {\r\n    if (!valueToSearch) return false;\r\n\r\n    setEntityMediaResults([]);\r\n    setResultsLoading(true);\r\n    let newEntityMediaResults = [];\r\n\r\n    // define first query\r\n    let sparqlQuery = `\r\n      SELECT ?file ?thumb ?fileOrig ?fileLabel ?encoding WHERE {\r\n        ?file wdt:P180 wd:${valueToSearch.id} .\r\n        ?file schema:contentUrl ?url .\r\n        ?file schema:encodingFormat ?encoding .\r\n        SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }\r\n        bind(iri(concat(\"http://commons.wikimedia.org/wiki/Special:FilePath/\", wikibase:decodeUri(substr(str(?url),53)), \"?width=${isMobile ? 100 : 200}\")) AS ?thumb)\r\n        bind(iri(concat(\"http://commons.wikimedia.org/wiki/Special:FilePath/\", wikibase:decodeUri(substr(str(?url),53)))) AS ?fileOrig)\r\n      } limit ${MEDIA_LIMIT}\r\n    `;\r\n\r\n    const queryDispatcher = new SPARQLQueryDispatcher(WCQS_ENDPOINT);\r\n\r\n    queryDispatcher.query(sparqlQuery).then((data) => {\r\n      newEntityMediaResults = newEntityMediaResults.concat(data.results.bindings);\r\n      setNoResults(false);\r\n\r\n      setEntityMediaResults([...newEntityMediaResults]);\r\n\r\n      if (!includeSubclassSearch) {\r\n        if (newEntityMediaResults.length === 0) setNoResults(true);\r\n        setResultsLoading(false);\r\n        return true;\r\n      }\r\n\r\n      if (newEntityMediaResults.length > 0) setResultsLoading(false);\r\n\r\n      // define query that searches for subclasses as well\r\n      sparqlQuery = `\r\n        SELECT DISTINCT ?item ?itemLabel ?image ?file ?thumb ?fileOrig ?fileLabel ?encoding\r\n        WITH \r\n        { SELECT ?item ?itemLabel WHERE\r\n          { SERVICE <https://query.wikidata.org/sparql> \r\n            { ?item wdt:P31/wdt:P279* wd:${valueToSearch.id} .\r\n              SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". ?item rdfs:label ?itemLabel .}\r\n            }\r\n          }\r\n        } AS %Wikidataitems\r\n  \r\n        WHERE {\r\n          INCLUDE %Wikidataitems .\r\n          ?file wdt:P180 ?item.\r\n          ?file schema:contentUrl ?url .\r\n          ?file schema:encodingFormat ?encoding .\r\n          SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }\r\n          bind(iri(concat(\"http://commons.wikimedia.org/wiki/Special:FilePath/\", wikibase:decodeUri(substr(str(?url),53)), \"?width=${isMobile ? 100 : 200}\")) AS ?thumb)\r\n          bind(iri(concat(\"http://commons.wikimedia.org/wiki/Special:FilePath/\", wikibase:decodeUri(substr(str(?url),53)))) AS ?fileOrig)\r\n        } limit ${MEDIA_LIMIT}\r\n      `;\r\n\r\n      // eslint-disable-next-line no-shadow\r\n      queryDispatcher.query(sparqlQuery).then((data) => {\r\n        newEntityMediaResults = newEntityMediaResults.concat(data.results.bindings);\r\n        setEntityMediaResults([...newEntityMediaResults]);\r\n        if (newEntityMediaResults.length === 0) setNoResults(true);\r\n        setResultsLoading(false);\r\n      });\r\n\r\n      return true;\r\n    });\r\n\r\n    return true;\r\n  }, [includeSubclassSearch, setEntityMediaResults, setNoResults, setResultsLoading]);\r\n\r\n  const handleOnValueChange = (event, newValue) => {\r\n    setValue(newValue);\r\n  };\r\n\r\n  // search again on includeSubclassSearch\r\n  useEffect(() => {\r\n    searchCommons(value);\r\n  }, [includeSubclassSearch, value, searchCommons]);\r\n\r\n  useEffect(() => {\r\n    if (inputValue === '') {\r\n      setNoResults(false);\r\n      return undefined;\r\n    }\r\n\r\n    if (timer.current) {\r\n      clearTimeout(timer.current);\r\n    }\r\n\r\n    timer.current = setTimeout(() => {\r\n      setLoading(true);\r\n      const url = wdk.searchEntities(inputValue);\r\n      fetch(url)\r\n        .then((response) => response.json())\r\n        .then((data) => {\r\n          setInputSearchResults(data.search);\r\n          setLoading(false);\r\n        });\r\n    }, TIMEOUT_FOR_SEARCH);\r\n\r\n    return true;\r\n  }, [inputValue, setNoResults]);\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <div className={classes.searchSettingsWrapper}>\r\n        <SearchSettings\r\n          setIncludeSubclassSearch={setIncludeSubclassSearch}\r\n          includeSubclassSearch={includeSubclassSearch}\r\n        />\r\n      </div>\r\n\r\n      <Autocomplete\r\n        clearOnBlur={false}\r\n        autoHighlight\r\n        options={inputSearchResults}\r\n        renderOption={(option) => <SearchResultOption option={option} />}\r\n        // eslint-disable-next-line no-shadow\r\n        getOptionSelected={(option, value) => option.title === value.title}\r\n        getOptionLabel={(option) => option.label}\r\n        loading={loading}\r\n        filterOptions={(x) => x}\r\n        value={value}\r\n        size=\"small\"\r\n        onChange={handleOnValueChange}\r\n        onInputChange={(event, newInputValue) => {\r\n          setInputValue(newInputValue);\r\n        }}\r\n        className={classes.autocomplete}\r\n        renderInput={(params) => (\r\n          <TextField\r\n            {...params}\r\n            label=\"Search Commons...\"\r\n            variant=\"outlined\"\r\n            InputProps={{\r\n              ...params.InputProps,\r\n              endAdornment: (\r\n                <>\r\n                  {loading ? <CircularProgress color=\"inherit\" size={20} /> : null}\r\n                  {inputSearchResults.length > 0 ? params.InputProps.endAdornment : null}\r\n                </>\r\n              ),\r\n            }}\r\n          />\r\n        )}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Input;\r\n","import React, { Children, useState } from 'react';\r\nimport {\r\n  Box, CircularProgress, makeStyles, Typography,\r\n} from '@material-ui/core';\r\nimport { isMobile } from 'react-device-detect';\r\nimport { Lightbox } from 'react-modal-image';\r\nimport MediaBox from './components/MediaBox';\r\nimport Input from './components/Input';\r\n\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    padding: isMobile ? '10px' : '25px 50px',\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n\r\n  inputWrapper: {\r\n    marginBottom: 8,\r\n    width: '100%',\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n\r\n  loadingWrapper: {\r\n    position: 'absolute',\r\n    top: '50%',\r\n  },\r\n\r\n  count: {\r\n    marginTop: 8,\r\n  },\r\n});\r\n\r\nconst App = () => {\r\n  const classes = useStyles();\r\n  const [entityMediaResults, setEntityMediaResults] = useState([]);\r\n  const [noResults, setNoResults] = useState(false);\r\n  const [selectedImage, setSelectedImage] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const closeLightbox = () => {\r\n    setSelectedImage(false);\r\n  };\r\n\r\n  console.log(entityMediaResults, 'entityMediaResults');\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <div className={classes.inputWrapper}>\r\n        <Input\r\n          setNoResults={setNoResults}\r\n          setEntityMediaResults={setEntityMediaResults}\r\n          setResultsLoading={setLoading}\r\n        />\r\n        {entityMediaResults.length > 0 && (\r\n          <small className={classes.count}>{`${entityMediaResults.length} results`}</small>\r\n        )}\r\n      </div>\r\n\r\n      {loading && (\r\n        <div className={classes.loadingWrapper}>\r\n          <CircularProgress />\r\n        </div>\r\n      )}\r\n\r\n      {entityMediaResults.length > 0 && (\r\n        <Box display=\"flex\" flexWrap=\"wrap\" justifyContent=\"center\">\r\n          {Children.toArray(entityMediaResults.map((result) => (\r\n            <MediaBox data={result} onClick={() => setSelectedImage(result)} />\r\n          )))}\r\n        </Box>\r\n      )}\r\n\r\n      {noResults && <Typography>No results...</Typography>}\r\n\r\n      {selectedImage && (\r\n        <Lightbox\r\n          large={selectedImage.fileOrig.value}\r\n          alt={selectedImage.file.value}\r\n          onClose={closeLightbox}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default App;\r\n","const reportWebVitals = (onPerfEntry) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({\n      getCLS, getFID, getFCP, getLCP, getTTFB,\n    }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport { CssBaseline } from '@material-ui/core';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <CssBaseline />\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root'),\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}